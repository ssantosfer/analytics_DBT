[0m18:24:26.268142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34edeaabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ebe12020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ebe11fc0>]}


============================== 18:24:26.271451 | abbcf021-bd2a-441f-bc8d-3aeb959cbe52 ==============================
[0m18:24:26.271451 [info ] [MainThread]: Running with dbt=1.7.3
[0m18:24:26.272260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/fer/.dbt', 'log_path': '/home/fer/analytics_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:24:26.272686 [info ] [MainThread]: dbt version: 1.7.3
[0m18:24:26.273056 [info ] [MainThread]: python version: 3.10.12
[0m18:24:26.273390 [info ] [MainThread]: python path: /home/fer/dbt-env/bin/python
[0m18:24:26.273715 [info ] [MainThread]: os info: Linux-6.2.0-37-generic-x86_64-with-glibc2.35
[0m18:24:26.572898 [info ] [MainThread]: Using profiles dir at /home/fer/.dbt
[0m18:24:26.573761 [info ] [MainThread]: Using profiles.yml file at /home/fer/.dbt/profiles.yml
[0m18:24:26.574208 [info ] [MainThread]: Using dbt_project.yml file at /home/fer/analytics_dbt/dbt_project.yml
[0m18:24:26.574837 [info ] [MainThread]: adapter type: redshift
[0m18:24:26.575234 [info ] [MainThread]: adapter version: 1.7.1
[0m18:24:26.679004 [info ] [MainThread]: Configuration:
[0m18:24:26.680109 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:24:26.680663 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:24:26.681058 [info ] [MainThread]: Required dependencies:
[0m18:24:26.681477 [debug] [MainThread]: Executing "git --help"
[0m18:24:26.687142 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:24:26.687725 [debug] [MainThread]: STDERR: "b''"
[0m18:24:26.688043 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:24:26.688604 [info ] [MainThread]: Connection:
[0m18:24:26.688995 [info ] [MainThread]:   host: redshift-cluster-1.ckbtftqiyrh0.us-east-2.redshift.amaz
[0m18:24:26.689338 [info ] [MainThread]:   user: awsuser
[0m18:24:26.689703 [info ] [MainThread]:   port: 5439
[0m18:24:26.690020 [info ] [MainThread]:   database: dev
[0m18:24:26.690363 [info ] [MainThread]:   method: database
[0m18:24:26.690616 [info ] [MainThread]:   cluster_id: None
[0m18:24:26.690936 [info ] [MainThread]:   iam_profile: None
[0m18:24:26.691253 [info ] [MainThread]:   schema: public
[0m18:24:26.691611 [info ] [MainThread]:   sslmode: prefer
[0m18:24:26.691924 [info ] [MainThread]:   region: None
[0m18:24:26.692377 [info ] [MainThread]:   sslmode: prefer
[0m18:24:26.692692 [info ] [MainThread]:   region: None
[0m18:24:26.693001 [info ] [MainThread]:   iam_profile: None
[0m18:24:26.693329 [info ] [MainThread]:   autocreate: False
[0m18:24:26.693641 [info ] [MainThread]:   db_groups: []
[0m18:24:26.693950 [info ] [MainThread]:   ra3_node: False
[0m18:24:26.694257 [info ] [MainThread]:   connect_timeout: None
[0m18:24:26.694595 [info ] [MainThread]:   role: None
[0m18:24:26.694903 [info ] [MainThread]:   retries: 1
[0m18:24:26.695242 [info ] [MainThread]:   autocommit: True
[0m18:24:26.696239 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m18:24:26.697712 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m18:24:26.704351 [debug] [MainThread]: Using redshift connection "debug"
[0m18:24:26.704830 [debug] [MainThread]: On debug: select 1 as id
[0m18:24:26.705107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:26.708626 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:24:26.709080 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:24:26.792751 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m18:24:26.793662 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m18:24:26.794029 [debug] [MainThread]: On debug: No close available on handle
[0m18:24:26.794346 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:24:26.794783 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:24:26.795424 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', gaierror(-2, 'Name or service not known'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:24:26.797521 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.5784864, "process_user_time": 2.081904, "process_kernel_time": 0.335644, "process_mem_max_rss": "106252", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m18:24:26.798836 [debug] [MainThread]: Command `dbt debug` failed at 18:24:26.798624 after 0.58 seconds
[0m18:24:26.799542 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:24:26.800041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34edeaabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34eb18e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34ebd7ed10>]}
[0m18:24:26.801388 [debug] [MainThread]: Flushing usage events
[0m19:43:45.055823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfdc7aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfbaea020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfbae9fc0>]}


============================== 19:43:45.062432 | cd66191b-f92f-4991-9a63-d8f25f451301 ==============================
[0m19:43:45.062432 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:43:45.063262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/fer/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/fer/analytics_DBT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:43:45.064175 [info ] [MainThread]: dbt version: 1.7.3
[0m19:43:45.065094 [info ] [MainThread]: python version: 3.10.12
[0m19:43:45.065638 [info ] [MainThread]: python path: /home/fer/dbt-env/bin/python
[0m19:43:45.066109 [info ] [MainThread]: os info: Linux-6.2.0-37-generic-x86_64-with-glibc2.35
[0m19:43:45.311468 [info ] [MainThread]: Using profiles dir at /home/fer/.dbt
[0m19:43:45.312413 [info ] [MainThread]: Using profiles.yml file at /home/fer/.dbt/profiles.yml
[0m19:43:45.313215 [info ] [MainThread]: Using dbt_project.yml file at /home/fer/analytics_DBT/dbt_project.yml
[0m19:43:45.313925 [info ] [MainThread]: adapter type: redshift
[0m19:43:45.314286 [info ] [MainThread]: adapter version: 1.7.1
[0m19:43:45.386669 [info ] [MainThread]: Configuration:
[0m19:43:45.391827 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:43:45.392217 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:43:45.399143 [info ] [MainThread]: Required dependencies:
[0m19:43:45.399973 [debug] [MainThread]: Executing "git --help"
[0m19:43:45.412917 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:43:45.414154 [debug] [MainThread]: STDERR: "b''"
[0m19:43:45.414791 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:43:45.415280 [info ] [MainThread]: Connection:
[0m19:43:45.415754 [info ] [MainThread]:   host: redshift-cluster-1.ckbtftqiyrh0.us-east-2.redshift.amaz
[0m19:43:45.416320 [info ] [MainThread]:   user: awsuser
[0m19:43:45.416736 [info ] [MainThread]:   port: 5439
[0m19:43:45.417139 [info ] [MainThread]:   database: dev
[0m19:43:45.417548 [info ] [MainThread]:   method: database
[0m19:43:45.417961 [info ] [MainThread]:   cluster_id: None
[0m19:43:45.418395 [info ] [MainThread]:   iam_profile: None
[0m19:43:45.418815 [info ] [MainThread]:   schema: public
[0m19:43:45.419109 [info ] [MainThread]:   sslmode: prefer
[0m19:43:45.419368 [info ] [MainThread]:   region: None
[0m19:43:45.419622 [info ] [MainThread]:   sslmode: prefer
[0m19:43:45.419874 [info ] [MainThread]:   region: None
[0m19:43:45.420127 [info ] [MainThread]:   iam_profile: None
[0m19:43:45.420793 [info ] [MainThread]:   autocreate: False
[0m19:43:45.421211 [info ] [MainThread]:   db_groups: []
[0m19:43:45.421557 [info ] [MainThread]:   ra3_node: False
[0m19:43:45.422287 [info ] [MainThread]:   connect_timeout: None
[0m19:43:45.422643 [info ] [MainThread]:   role: None
[0m19:43:45.423040 [info ] [MainThread]:   retries: 1
[0m19:43:45.423456 [info ] [MainThread]:   autocommit: True
[0m19:43:45.423955 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m19:43:45.429808 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m19:43:45.438521 [debug] [MainThread]: Using redshift connection "debug"
[0m19:43:45.439273 [debug] [MainThread]: On debug: select 1 as id
[0m19:43:45.439703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:43:45.443040 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:43:45.443525 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:43:45.521636 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m19:43:45.522283 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m19:43:45.522728 [debug] [MainThread]: On debug: No close available on handle
[0m19:43:45.523118 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m19:43:45.523577 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:43:45.524047 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', gaierror(-2, 'Name or service not known'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m19:43:45.526669 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.52101606, "process_user_time": 1.041756, "process_kernel_time": 1.480391, "process_mem_max_rss": "106216", "process_in_blocks": "13216", "process_out_blocks": "16", "command_success": false}
[0m19:43:45.527358 [debug] [MainThread]: Command `dbt debug` failed at 19:43:45.527217 after 0.52 seconds
[0m19:43:45.527860 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:43:45.528444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfdc7aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfab12530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbfe40aef0>]}
[0m19:43:45.528920 [debug] [MainThread]: Flushing usage events
[0m19:51:46.935742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbcb87700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbaa6a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbaa6a050>]}


============================== 19:51:46.938552 | 85722fb5-b796-4606-ae05-2a3318131e60 ==============================
[0m19:51:46.938552 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:51:46.939273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/fer/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/fer/analytics_DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:46.939715 [info ] [MainThread]: dbt version: 1.7.3
[0m19:51:46.940333 [info ] [MainThread]: python version: 3.10.12
[0m19:51:46.940712 [info ] [MainThread]: python path: /home/fer/dbt-env/bin/python
[0m19:51:46.941099 [info ] [MainThread]: os info: Linux-6.2.0-37-generic-x86_64-with-glibc2.35
[0m19:51:47.126228 [info ] [MainThread]: Using profiles dir at /home/fer/.dbt
[0m19:51:47.127187 [info ] [MainThread]: Using profiles.yml file at /home/fer/.dbt/profiles.yml
[0m19:51:47.127714 [info ] [MainThread]: Using dbt_project.yml file at /home/fer/analytics_DBT/dbt_project.yml
[0m19:51:47.128490 [info ] [MainThread]: adapter type: redshift
[0m19:51:47.128929 [info ] [MainThread]: adapter version: 1.7.1
[0m19:51:47.197527 [info ] [MainThread]: Configuration:
[0m19:51:47.198405 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:51:47.198876 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:51:47.199149 [info ] [MainThread]: Required dependencies:
[0m19:51:47.199476 [debug] [MainThread]: Executing "git --help"
[0m19:51:47.203752 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:51:47.204536 [debug] [MainThread]: STDERR: "b''"
[0m19:51:47.204971 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:51:47.205529 [info ] [MainThread]: Connection:
[0m19:51:47.206003 [info ] [MainThread]:   host: redshift-cluster-1.ckbtftqiyrh0.us-east-2.redshift.amazonaws.com
[0m19:51:47.206491 [info ] [MainThread]:   user: awsuser
[0m19:51:47.206870 [info ] [MainThread]:   port: 5439
[0m19:51:47.207311 [info ] [MainThread]:   database: dev
[0m19:51:47.207785 [info ] [MainThread]:   method: database
[0m19:51:47.208301 [info ] [MainThread]:   cluster_id: None
[0m19:51:47.208767 [info ] [MainThread]:   iam_profile: None
[0m19:51:47.209237 [info ] [MainThread]:   schema: public
[0m19:51:47.209669 [info ] [MainThread]:   sslmode: prefer
[0m19:51:47.210183 [info ] [MainThread]:   region: None
[0m19:51:47.210569 [info ] [MainThread]:   sslmode: prefer
[0m19:51:47.210983 [info ] [MainThread]:   region: None
[0m19:51:47.211298 [info ] [MainThread]:   iam_profile: None
[0m19:51:47.211606 [info ] [MainThread]:   autocreate: False
[0m19:51:47.211881 [info ] [MainThread]:   db_groups: []
[0m19:51:47.212152 [info ] [MainThread]:   ra3_node: False
[0m19:51:47.212572 [info ] [MainThread]:   connect_timeout: None
[0m19:51:47.212896 [info ] [MainThread]:   role: None
[0m19:51:47.213247 [info ] [MainThread]:   retries: 1
[0m19:51:47.213575 [info ] [MainThread]:   autocommit: True
[0m19:51:47.214026 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m19:51:47.221096 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m19:51:47.225799 [debug] [MainThread]: Using redshift connection "debug"
[0m19:51:47.226809 [debug] [MainThread]: On debug: select 1 as id
[0m19:51:47.227860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:47.231564 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:51:47.232137 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:51:48.538866 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m19:51:48.542661 [debug] [MainThread]: On debug: Close
[0m19:51:48.546569 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:51:48.547560 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:51:48.548802 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.6524328, "process_user_time": 0.973678, "process_kernel_time": 1.051573, "process_mem_max_rss": "107992", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m19:51:48.549853 [debug] [MainThread]: Command `dbt debug` succeeded at 19:51:48.549670 after 1.65 seconds
[0m19:51:48.550265 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:51:48.550699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbcb87700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbaa69ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fba415690>]}
[0m19:51:48.551175 [debug] [MainThread]: Flushing usage events
[0m19:56:19.174265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0b786050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a095fa1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a095fa140>]}


============================== 19:56:19.179409 | a981c6a5-5045-4f04-9f2c-8e577221b220 ==============================
[0m19:56:19.179409 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:56:19.180696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/fer/analytics_DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/home/fer/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:56:19.530371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a981c6a5-5045-4f04-9f2c-8e577221b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a08fa0a60>]}
[0m19:56:19.623357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a981c6a5-5045-4f04-9f2c-8e577221b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a085504c0>]}
[0m19:56:19.624586 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m19:56:19.639386 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:56:19.640364 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:56:19.641155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a981c6a5-5045-4f04-9f2c-8e577221b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a08fa0bb0>]}
[0m19:56:21.779637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a981c6a5-5045-4f04-9f2c-8e577221b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0711c0d0>]}
[0m19:56:21.843326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a981c6a5-5045-4f04-9f2c-8e577221b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a08551b70>]}
[0m19:56:21.844122 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m19:56:21.844844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a981c6a5-5045-4f04-9f2c-8e577221b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a08169630>]}
[0m19:56:21.846341 [info ] [MainThread]: 
[0m19:56:21.847224 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m19:56:21.849437 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m19:56:21.885640 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:56:21.886197 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m19:56:21.887138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:21.890227 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:56:21.890676 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:56:23.326088 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:56:23.329632 [debug] [ThreadPool]: On list_dev: Close
[0m19:56:23.333226 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m19:56:23.341637 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:56:23.342419 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m19:56:23.342918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:23.343566 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:56:23.344159 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:56:24.617016 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m19:56:24.618104 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:56:24.618955 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m19:56:24.950136 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:24.953553 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m19:56:25.270760 [debug] [ThreadPool]: On list_dev_public: Close
[0m19:56:25.293629 [debug] [MainThread]: Using redshift connection "master"
[0m19:56:25.295294 [debug] [MainThread]: On master: BEGIN
[0m19:56:25.296230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:25.297088 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:56:25.297641 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:56:26.586486 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m19:56:26.587813 [debug] [MainThread]: Using redshift connection "master"
[0m19:56:26.588632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m19:56:26.956636 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:26.958051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a981c6a5-5045-4f04-9f2c-8e577221b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0711cf70>]}
[0m19:56:26.958686 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:27.297114 [debug] [MainThread]: Using redshift connection "master"
[0m19:56:27.298458 [debug] [MainThread]: On master: BEGIN
[0m19:56:27.452921 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:27.453477 [debug] [MainThread]: On master: COMMIT
[0m19:56:27.453964 [debug] [MainThread]: Using redshift connection "master"
[0m19:56:27.454285 [debug] [MainThread]: On master: COMMIT
[0m19:56:27.767657 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:27.768263 [debug] [MainThread]: On master: Close
[0m19:56:27.770634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:27.771283 [info ] [MainThread]: 
[0m19:56:27.779569 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m19:56:27.780599 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:56:27.783324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.my_first_dbt_model)
[0m19:56:27.784199 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m19:56:27.790555 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:56:27.791748 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 19:56:27.784638 => 19:56:27.791422
[0m19:56:27.793085 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m19:56:27.837961 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m19:56:27.839614 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:56:27.840269 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:56:27.840697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:27.841293 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:56:27.841735 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:56:29.168846 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:56:29.169647 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:56:29.170650 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:56:30.293611 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:56:30.303497 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:56:30.304430 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:56:30.925945 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:56:30.944011 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:56:30.944988 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:56:30.945502 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:56:32.390874 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:56:32.394021 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:56:32.394923 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:56:32.713948 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:32.722818 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m19:56:32.728397 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:56:32.729552 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:56:33.043580 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:33.045538 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:56:33.046478 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:56:33.047110 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:56:33.212749 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:33.213511 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:56:33.214144 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:56:33.369282 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:33.370687 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 19:56:27.793770 => 19:56:33.370377
[0m19:56:33.371228 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m19:56:33.684054 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m19:56:33.686696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a981c6a5-5045-4f04-9f2c-8e577221b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a05578040>]}
[0m19:56:33.687712 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 5.90s]
[0m19:56:33.689035 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m19:56:33.690325 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m19:56:33.690841 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:56:33.693424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.my_second_dbt_model)
[0m19:56:33.694034 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m19:56:33.697311 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:56:33.698052 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 19:56:33.694350 => 19:56:33.697808
[0m19:56:33.698468 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m19:56:33.732451 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m19:56:33.734007 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:56:33.734506 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:56:33.734944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:33.735537 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:56:33.735999 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:56:34.985755 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:56:34.986666 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:56:34.987701 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m19:56:35.455674 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:35.462123 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:56:35.462944 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:56:35.917670 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:35.921297 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:56:35.922018 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:56:35.922507 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:56:36.253826 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:36.255151 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:56:36.255944 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:56:36.561571 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:36.566923 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m19:56:36.570268 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:56:36.570785 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:56:36.873202 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:36.875535 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:56:36.877199 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:56:36.877879 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:56:37.059095 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:37.060209 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:56:37.060775 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:56:37.243072 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:37.245081 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 19:56:33.699409 => 19:56:37.244816
[0m19:56:37.245767 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m19:56:37.545638 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m19:56:37.547159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a981c6a5-5045-4f04-9f2c-8e577221b220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a04412e60>]}
[0m19:56:37.548232 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 3.85s]
[0m19:56:37.549063 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m19:56:37.550998 [debug] [MainThread]: Using redshift connection "master"
[0m19:56:37.551360 [debug] [MainThread]: On master: BEGIN
[0m19:56:37.551728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:37.552229 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:56:37.552533 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:56:38.832610 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m19:56:38.834271 [debug] [MainThread]: On master: COMMIT
[0m19:56:38.835567 [debug] [MainThread]: Using redshift connection "master"
[0m19:56:38.836794 [debug] [MainThread]: On master: COMMIT
[0m19:56:39.149121 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:56:39.149825 [debug] [MainThread]: On master: Close
[0m19:56:39.151873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:39.152542 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:56:39.152927 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m19:56:39.153424 [info ] [MainThread]: 
[0m19:56:39.153862 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 17.31 seconds (17.31s).
[0m19:56:39.154629 [debug] [MainThread]: Command end result
[0m19:56:39.230504 [info ] [MainThread]: 
[0m19:56:39.231699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:39.232590 [info ] [MainThread]: 
[0m19:56:39.233129 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:56:39.234778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.137848, "process_user_time": 3.898976, "process_kernel_time": 1.041624, "process_mem_max_rss": "123628", "process_in_blocks": "6200", "process_out_blocks": "2848"}
[0m19:56:39.235534 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:39.235389 after 20.14 seconds
[0m19:56:39.236000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0b786050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a08998280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a08fa0a60>]}
[0m19:56:39.236622 [debug] [MainThread]: Flushing usage events
[0m20:16:10.929358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513848eaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513635a170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513635a110>]}


============================== 20:16:10.937413 | e10a744d-5819-4c25-9da5-2c0bf8a78e67 ==============================
[0m20:16:10.937413 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:16:10.938133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/fer/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/fer/analytics_DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:16:11.363086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e10a744d-5819-4c25-9da5-2c0bf8a78e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513635a1a0>]}
[0m20:16:11.477475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e10a744d-5819-4c25-9da5-2c0bf8a78e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135350820>]}
[0m20:16:11.478981 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m20:16:11.495605 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:16:11.526757 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:16:11.527553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e10a744d-5819-4c25-9da5-2c0bf8a78e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51353514e0>]}
[0m20:16:12.609698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e10a744d-5819-4c25-9da5-2c0bf8a78e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5133f440d0>]}
[0m20:16:12.647194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e10a744d-5819-4c25-9da5-2c0bf8a78e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5135353a90>]}
[0m20:16:12.648598 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:16:12.649593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e10a744d-5819-4c25-9da5-2c0bf8a78e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5137aa1f00>]}
[0m20:16:12.652738 [info ] [MainThread]: 
[0m20:16:12.654036 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:16:12.655970 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:16:12.684847 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:16:12.686094 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:16:12.686610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:12.690134 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:12.690871 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:16:14.132006 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:16:14.133931 [debug] [ThreadPool]: On list_dev: Close
[0m20:16:14.137229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m20:16:14.144041 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:16:14.144981 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:16:14.145309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:14.145785 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:14.146147 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:16:15.433039 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:16:15.434477 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:16:15.435117 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:16:15.771081 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:15.772758 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:16:16.088524 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:16:16.102468 [debug] [MainThread]: Using redshift connection "master"
[0m20:16:16.103153 [debug] [MainThread]: On master: BEGIN
[0m20:16:16.103626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:16.104421 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:16.104907 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:16:17.425402 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:16:17.426482 [debug] [MainThread]: Using redshift connection "master"
[0m20:16:17.427459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:16:17.844322 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:17.847963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e10a744d-5819-4c25-9da5-2c0bf8a78e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5133f45270>]}
[0m20:16:17.849091 [debug] [MainThread]: On master: ROLLBACK
[0m20:16:18.217120 [debug] [MainThread]: Using redshift connection "master"
[0m20:16:18.218192 [debug] [MainThread]: On master: BEGIN
[0m20:16:18.404263 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:18.405050 [debug] [MainThread]: On master: COMMIT
[0m20:16:18.405613 [debug] [MainThread]: Using redshift connection "master"
[0m20:16:18.406021 [debug] [MainThread]: On master: COMMIT
[0m20:16:18.738307 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:18.739575 [debug] [MainThread]: On master: Close
[0m20:16:18.744077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:18.745106 [info ] [MainThread]: 
[0m20:16:18.751725 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:16:18.752625 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:16:18.753541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.my_first_dbt_model)
[0m20:16:18.753976 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:16:18.757725 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:16:18.758923 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:16:18.754257 => 20:16:18.758531
[0m20:16:18.759374 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:16:18.807177 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:16:18.809254 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:18.809808 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:16:18.810264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:18.810863 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:18.811293 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:16:20.091939 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:16:20.093046 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:20.093736 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:16:20.459733 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:20.466242 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:16:20.467432 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:20.468020 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:16:20.826567 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:20.827999 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:20.829036 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:16:20.992533 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:21.000053 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:16:21.005498 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:21.006392 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:16:21.342781 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:21.344106 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:16:21.344975 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:21.346211 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:16:21.539509 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:21.540269 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:21.540898 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:16:21.701301 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:21.711087 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:21.711704 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:16:22.591029 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:16:22.620646 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:16:22.621610 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:22.622183 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:16:23.095613 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:23.096879 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:23.097554 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:16:23.581934 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:23.586903 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:16:23.588401 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:23.589000 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:16:23.915365 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:23.916929 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:16:23.918098 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:23.918792 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:16:24.110967 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:24.111789 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:16:24.112465 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:16:24.278466 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:24.280627 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:16:18.759610 => 20:16:24.280419
[0m20:16:24.281189 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:16:24.590566 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:16:24.595190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e10a744d-5819-4c25-9da5-2c0bf8a78e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5133f45090>]}
[0m20:16:24.596282 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 5.84s]
[0m20:16:24.597378 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:16:24.598023 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:16:24.598661 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:16:24.599387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:16:24.599886 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:16:24.601973 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:16:24.603491 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:16:24.600299 => 20:16:24.603248
[0m20:16:24.603894 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:16:24.621245 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:16:24.624307 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:16:24.624826 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:16:24.625183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:24.625678 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:24.626055 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:16:25.898744 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:16:25.902213 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:16:25.902926 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales AS (
    SELECT
        *
    FROM sales
),
renamed AS (
    SELECT
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSÃO,
        SALETIME AS DATA_VENDA
    FROM source_sales
)
SELECT 
    *
FROM renamed
  ) ;
[0m20:16:26.373069 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:26.376884 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:16:26.377438 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:16:26.841321 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:26.845275 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:16:26.846337 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:16:26.847142 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:16:27.180774 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:27.181797 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:16:27.182342 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:16:27.493699 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:27.499268 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m20:16:27.502826 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:16:27.503477 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:16:27.809784 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:27.812456 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:16:27.813629 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:16:27.814346 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:16:28.024629 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:28.025658 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:16:28.026230 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:16:28.189894 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:28.193107 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:16:24.604135 => 20:16:28.192494
[0m20:16:28.194835 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:16:28.506184 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:16:28.511090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e10a744d-5819-4c25-9da5-2c0bf8a78e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5133bf4190>]}
[0m20:16:28.523286 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 3.91s]
[0m20:16:28.524608 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:16:28.525560 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:16:28.526282 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:16:28.527451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:16:28.527910 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:16:28.530951 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:16:28.532532 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:16:28.528336 => 20:16:28.531884
[0m20:16:28.532992 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:16:28.537849 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:16:28.547461 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:16:28.548501 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:16:28.549098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:28.549728 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:28.550184 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:16:29.905388 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:16:29.906222 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:16:29.906941 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:16:30.403924 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:30.408372 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:16:30.409068 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:16:30.885705 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:30.887533 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:16:30.888054 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:16:30.888598 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:16:31.284866 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:31.286422 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:16:31.287685 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:16:31.617217 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:31.686386 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:16:31.688228 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:16:31.688986 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:16:32.042379 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:32.043805 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:16:32.044704 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:16:32.045178 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:16:32.238016 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:32.238788 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:16:32.239281 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:16:32.396483 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:32.397881 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:16:28.533269 => 20:16:32.397602
[0m20:16:32.398384 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:16:32.720799 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:16:32.724067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e10a744d-5819-4c25-9da5-2c0bf8a78e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513126bca0>]}
[0m20:16:32.724959 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.20s]
[0m20:16:32.725951 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:16:32.728081 [debug] [MainThread]: Using redshift connection "master"
[0m20:16:32.728582 [debug] [MainThread]: On master: BEGIN
[0m20:16:32.728940 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:16:32.729501 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:32.729848 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:16:34.178172 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:16:34.178689 [debug] [MainThread]: On master: COMMIT
[0m20:16:34.179063 [debug] [MainThread]: Using redshift connection "master"
[0m20:16:34.179343 [debug] [MainThread]: On master: COMMIT
[0m20:16:34.499611 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:16:34.501725 [debug] [MainThread]: On master: Close
[0m20:16:34.505979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:34.506627 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:16:34.507413 [info ] [MainThread]: 
[0m20:16:34.508419 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 21.85 seconds (21.85s).
[0m20:16:34.509551 [debug] [MainThread]: Command end result
[0m20:16:34.521488 [info ] [MainThread]: 
[0m20:16:34.522196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:34.522653 [info ] [MainThread]: 
[0m20:16:34.523173 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:16:34.526868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.640131, "process_user_time": 2.870889, "process_kernel_time": 2.56869, "process_mem_max_rss": "123016", "process_in_blocks": "160", "process_out_blocks": "2888"}
[0m20:16:34.527760 [debug] [MainThread]: Command `dbt run` succeeded at 20:16:34.527615 after 23.64 seconds
[0m20:16:34.528347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513848eaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5137aa1f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5133f42650>]}
[0m20:16:34.528708 [debug] [MainThread]: Flushing usage events
[0m20:25:37.038637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c0d82bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bebda140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bebda0e0>]}


============================== 20:25:37.042079 | 1ff7eacf-4691-4f53-822e-19df38dbb472 ==============================
[0m20:25:37.042079 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:25:37.042910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/fer/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/fer/analytics_DBT/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:25:37.346417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ff7eacf-4691-4f53-822e-19df38dbb472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8be77cd30>]}
[0m20:25:37.436346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ff7eacf-4691-4f53-822e-19df38dbb472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bd9156f0>]}
[0m20:25:37.437807 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m20:25:37.449242 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:25:37.492370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:37.493733 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m20:25:37.711895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ff7eacf-4691-4f53-822e-19df38dbb472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bcd5db40>]}
[0m20:25:37.726220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ff7eacf-4691-4f53-822e-19df38dbb472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bd5edde0>]}
[0m20:25:37.726914 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:25:37.727521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ff7eacf-4691-4f53-822e-19df38dbb472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bd5edf90>]}
[0m20:25:37.728975 [info ] [MainThread]: 
[0m20:25:37.730026 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:25:37.732394 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:25:37.753386 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:25:37.754410 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:25:37.754890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:37.758618 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:25:37.759267 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:25:39.166660 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:39.168473 [debug] [ThreadPool]: On list_dev: Close
[0m20:25:39.172338 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:25:39.179663 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:25:39.180467 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:25:39.181151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:39.182464 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:25:39.183244 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:25:40.453657 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:40.454279 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:25:40.455075 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:25:40.782000 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:40.783713 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:25:41.098734 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:25:41.111036 [debug] [MainThread]: Using redshift connection "master"
[0m20:25:41.111573 [debug] [MainThread]: On master: BEGIN
[0m20:25:41.111911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:41.112380 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:25:41.112720 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:25:42.367583 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:42.370298 [debug] [MainThread]: Using redshift connection "master"
[0m20:25:42.370880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:25:42.735060 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:42.737208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ff7eacf-4691-4f53-822e-19df38dbb472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bd5ecb80>]}
[0m20:25:42.737740 [debug] [MainThread]: On master: ROLLBACK
[0m20:25:43.075575 [debug] [MainThread]: Using redshift connection "master"
[0m20:25:43.076515 [debug] [MainThread]: On master: BEGIN
[0m20:25:43.237035 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:43.237599 [debug] [MainThread]: On master: COMMIT
[0m20:25:43.238025 [debug] [MainThread]: Using redshift connection "master"
[0m20:25:43.238343 [debug] [MainThread]: On master: COMMIT
[0m20:25:43.540119 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:43.541196 [debug] [MainThread]: On master: Close
[0m20:25:43.544661 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:43.545429 [info ] [MainThread]: 
[0m20:25:43.550314 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:25:43.552507 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:25:43.553409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.my_first_dbt_model)
[0m20:25:43.553872 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:25:43.557005 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:25:43.558281 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:25:43.554143 => 20:25:43.557833
[0m20:25:43.558794 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:25:43.610237 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:25:43.612397 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:43.612996 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:25:43.613440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:43.614061 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:25:43.614611 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:25:44.878352 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:44.879375 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:44.880500 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:25:45.261601 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:45.263841 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:25:45.265168 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:45.265847 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:25:45.644719 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:45.646226 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:45.647371 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:25:45.802483 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:45.810126 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:25:45.817278 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:45.818890 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:25:46.125724 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:46.127081 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:25:46.127749 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:46.128356 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:25:46.308844 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:46.309756 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:46.310365 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:25:46.461084 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:46.471416 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:46.472422 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:25:47.225229 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:47.245987 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:25:47.246766 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:47.247501 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:25:47.580523 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:47.581934 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:47.582655 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:25:47.887569 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:47.892285 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:25:47.894254 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:47.894860 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:25:48.198208 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:48.199675 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:25:48.200691 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:48.201310 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:25:48.366373 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:48.367690 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:25:48.368637 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:25:48.521553 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:48.523003 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:25:43.559087 => 20:25:48.522737
[0m20:25:48.523533 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:25:48.829274 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:25:48.831846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ff7eacf-4691-4f53-822e-19df38dbb472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bc9bcfd0>]}
[0m20:25:48.833636 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 5.28s]
[0m20:25:48.834650 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:25:48.835244 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:25:48.836211 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:25:48.837243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:25:48.837810 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:25:48.841385 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:25:48.842630 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:25:48.838231 => 20:25:48.842331
[0m20:25:48.843215 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:25:48.867089 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:25:48.870775 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:25:48.871390 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:25:48.871819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:48.872440 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:25:48.872911 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:25:50.175256 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:50.176408 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:25:50.177600 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales AS (
    SELECT
        *
    FROM sales
),
renamed AS (
    SELECT
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSÃO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA,
    FROM source_sales
)
SELECT 
    *
FROM renamed
  ) ;
[0m20:25:50.340229 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "FROM"
[0m20:25:50.340787 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:25:50.657278 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:25:48.843448 => 20:25:50.656706
[0m20:25:50.658116 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:25:50.668418 [debug] [Thread-1 (]: Database Error in model vw_sales (models/views/vw_sales.sql)
  syntax error at or near "FROM"
  compiled Code at target/run/analytics_dbt/models/views/vw_sales.sql
[0m20:25:50.669166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ff7eacf-4691-4f53-822e-19df38dbb472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b9d1d930>]}
[0m20:25:50.669877 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 1.83s]
[0m20:25:50.670730 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:25:50.671194 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:25:50.671744 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:25:50.672668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:25:50.673054 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:25:50.675873 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:25:50.677059 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:25:50.673305 => 20:25:50.676534
[0m20:25:50.677640 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:25:50.683471 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:25:50.685744 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:25:50.686578 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:25:50.687309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:50.688124 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:25:50.688962 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:25:51.970125 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:51.971219 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:25:51.972131 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:25:52.449665 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:52.455701 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:25:52.456470 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:25:52.922624 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:52.927278 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:25:52.928329 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:25:52.928938 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:25:53.278951 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:53.281361 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:25:53.282476 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:25:53.595844 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:53.602789 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:25:53.606443 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:25:53.607083 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:25:53.940565 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:53.943390 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:25:53.944230 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:25:53.944852 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:25:54.125026 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:54.125739 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:25:54.126166 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:25:54.288207 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:54.289988 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:25:50.677906 => 20:25:54.289716
[0m20:25:54.290629 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:25:54.601439 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:25:54.604051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ff7eacf-4691-4f53-822e-19df38dbb472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bc5b10f0>]}
[0m20:25:54.605621 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 3.93s]
[0m20:25:54.606631 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:25:54.609204 [debug] [MainThread]: Using redshift connection "master"
[0m20:25:54.609616 [debug] [MainThread]: On master: BEGIN
[0m20:25:54.609915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:54.610346 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:25:54.610682 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:25:56.001002 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:25:56.001664 [debug] [MainThread]: On master: COMMIT
[0m20:25:56.002367 [debug] [MainThread]: Using redshift connection "master"
[0m20:25:56.002839 [debug] [MainThread]: On master: COMMIT
[0m20:25:56.318697 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:25:56.320263 [debug] [MainThread]: On master: Close
[0m20:25:56.321991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:56.322492 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:25:56.322923 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:25:56.323574 [info ] [MainThread]: 
[0m20:25:56.324381 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 18.59 seconds (18.59s).
[0m20:25:56.325332 [debug] [MainThread]: Command end result
[0m20:25:56.336824 [info ] [MainThread]: 
[0m20:25:56.337682 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:25:56.338958 [info ] [MainThread]: 
[0m20:25:56.339558 [error] [MainThread]:   Database Error in model vw_sales (models/views/vw_sales.sql)
  syntax error at or near "FROM"
  compiled Code at target/run/analytics_dbt/models/views/vw_sales.sql
[0m20:25:56.340254 [info ] [MainThread]: 
[0m20:25:56.340809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:25:56.343035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 19.349848, "process_user_time": 2.671842, "process_kernel_time": 0.819583, "process_mem_max_rss": "120688", "process_in_blocks": "272", "process_out_blocks": "2888", "command_success": false}
[0m20:25:56.344359 [debug] [MainThread]: Command `dbt run` failed at 20:25:56.343930 after 19.35 seconds
[0m20:25:56.344828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8c0d82bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bc9e0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bc9e0fd0>]}
[0m20:25:56.345274 [debug] [MainThread]: Flushing usage events
[0m20:26:23.293414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64467b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64253e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64253e170>]}


============================== 20:26:23.296068 | 9341a169-9962-4a61-bcc7-9c1bc05688c3 ==============================
[0m20:26:23.296068 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:26:23.296837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/fer/.dbt', 'log_path': '/home/fer/analytics_DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:26:23.781900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9341a169-9962-4a61-bcc7-9c1bc05688c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64253e200>]}
[0m20:26:23.896910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9341a169-9962-4a61-bcc7-9c1bc05688c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64150f460>]}
[0m20:26:23.897720 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m20:26:23.911016 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:26:24.092812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:26:24.093786 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m20:26:24.370769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9341a169-9962-4a61-bcc7-9c1bc05688c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff640951bd0>]}
[0m20:26:24.432575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9341a169-9962-4a61-bcc7-9c1bc05688c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6411edea0>]}
[0m20:26:24.433207 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:26:24.434351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9341a169-9962-4a61-bcc7-9c1bc05688c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6411ee020>]}
[0m20:26:24.436537 [info ] [MainThread]: 
[0m20:26:24.437573 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:26:24.442771 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:26:24.485641 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:26:24.487893 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:26:24.488785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:24.491990 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:26:24.492674 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:26:25.824791 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:25.826419 [debug] [ThreadPool]: On list_dev: Close
[0m20:26:25.828858 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:26:25.834789 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:26:25.835463 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:26:25.835868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:25.836493 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:26:25.836909 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:26:27.127839 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:27.128587 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:26:27.129605 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:26:27.465443 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:27.467570 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:26:27.786127 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:26:27.798237 [debug] [MainThread]: Using redshift connection "master"
[0m20:26:27.798755 [debug] [MainThread]: On master: BEGIN
[0m20:26:27.799080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:27.799602 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:26:27.799934 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:26:29.078751 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:29.079819 [debug] [MainThread]: Using redshift connection "master"
[0m20:26:29.081227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:26:29.446482 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:29.451040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9341a169-9962-4a61-bcc7-9c1bc05688c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6411ecbb0>]}
[0m20:26:29.451973 [debug] [MainThread]: On master: ROLLBACK
[0m20:26:29.780961 [debug] [MainThread]: Using redshift connection "master"
[0m20:26:29.781499 [debug] [MainThread]: On master: BEGIN
[0m20:26:29.941264 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:29.942084 [debug] [MainThread]: On master: COMMIT
[0m20:26:29.942804 [debug] [MainThread]: Using redshift connection "master"
[0m20:26:29.943359 [debug] [MainThread]: On master: COMMIT
[0m20:26:30.247491 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:30.249295 [debug] [MainThread]: On master: Close
[0m20:26:30.251557 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:30.253100 [info ] [MainThread]: 
[0m20:26:30.258034 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:26:30.258686 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:26:30.259499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.my_first_dbt_model)
[0m20:26:30.260168 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:26:30.262750 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:26:30.263930 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:26:30.260450 => 20:26:30.263318
[0m20:26:30.264482 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:26:30.309935 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:26:30.312222 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:30.312820 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:26:30.313254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:30.313850 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:26:30.314269 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:26:31.599615 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:31.601590 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:31.602806 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:26:31.965696 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:31.967116 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:26:31.967599 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:31.967924 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:26:32.328787 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:32.330454 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:32.331552 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:26:32.492986 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:32.501196 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:26:32.505528 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:32.506042 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:26:32.850412 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:32.853531 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:26:32.854371 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:32.855035 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:26:33.043829 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:33.044532 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:33.044944 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:26:33.214743 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:33.223170 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:33.223771 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:26:34.014822 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:34.039471 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:26:34.040414 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:34.040953 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:26:34.380650 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:34.381589 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:34.382105 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:26:34.695084 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:34.699928 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:26:34.701347 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:34.701778 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:26:35.022698 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:35.024697 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:26:35.025394 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:35.025871 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:26:35.204051 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:35.205990 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:26:35.207155 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:26:35.367658 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:35.370714 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:26:30.264696 => 20:26:35.368847
[0m20:26:35.371598 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:26:35.685594 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:26:35.689173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9341a169-9962-4a61-bcc7-9c1bc05688c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6405b9240>]}
[0m20:26:35.690504 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 5.43s]
[0m20:26:35.691665 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:26:35.692409 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:26:35.693009 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:26:35.694349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:26:35.694796 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:26:35.697781 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:26:35.698701 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:26:35.695067 => 20:26:35.698421
[0m20:26:35.699271 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:26:35.720375 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:26:35.724200 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:35.724926 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:26:35.725359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:35.725908 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:26:35.726363 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:26:37.111157 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:37.111857 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:37.112775 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales AS (
    SELECT
        *
    FROM sales
),
renamed AS (
    SELECT
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSÃO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA
    FROM source_sales
)
SELECT 
    *
FROM renamed
  ) ;
[0m20:26:37.594287 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:37.597800 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:26:37.599076 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:37.599476 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:26:37.946397 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:37.948402 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:37.949760 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:26:38.265137 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:38.268957 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m20:26:38.272326 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:38.272798 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m20:26:38.595565 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:38.596602 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:26:38.597065 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:38.597394 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:26:38.781401 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:38.782984 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:38.784145 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:26:38.941529 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:38.947915 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:38.948938 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:26:39.578941 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:39.582071 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:26:39.582750 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:39.583192 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:26:39.924832 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:39.926794 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:39.927620 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:26:40.242830 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:40.248885 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m20:26:40.251236 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:40.251793 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:26:40.566579 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:40.569565 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:26:40.571312 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:40.572249 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:26:40.753929 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:40.755724 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:26:40.757143 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:26:40.915380 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:40.916839 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:26:35.699536 => 20:26:40.916633
[0m20:26:40.917513 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:26:41.229342 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:26:41.233376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9341a169-9962-4a61-bcc7-9c1bc05688c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64094aef0>]}
[0m20:26:41.234272 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 5.54s]
[0m20:26:41.234999 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:26:41.235498 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:26:41.236177 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:26:41.237073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:26:41.237500 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:26:41.240113 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:26:41.241369 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:26:41.237770 => 20:26:41.240853
[0m20:26:41.241898 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:26:41.246770 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:26:41.249262 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:26:41.249782 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:26:41.250202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:41.250802 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:26:41.251355 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:26:42.604341 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:42.605874 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:26:42.606995 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:26:43.075928 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:43.083772 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:26:43.084724 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:26:43.554621 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:43.558607 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:26:43.559721 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:26:43.560372 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:26:43.903057 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:43.905180 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:26:43.905681 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:26:44.242478 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:44.249561 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:26:44.251662 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:26:44.252271 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:26:44.558954 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:44.561319 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:26:44.562809 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:26:44.563325 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:26:44.747990 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:44.748925 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:26:44.749433 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:26:44.906414 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:44.909627 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:26:41.242211 => 20:26:44.909006
[0m20:26:44.911256 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:26:45.243404 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:26:45.247412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9341a169-9962-4a61-bcc7-9c1bc05688c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6411ece20>]}
[0m20:26:45.248485 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.01s]
[0m20:26:45.249375 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:26:45.252235 [debug] [MainThread]: Using redshift connection "master"
[0m20:26:45.252648 [debug] [MainThread]: On master: BEGIN
[0m20:26:45.253379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:45.254008 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:26:45.254421 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:26:46.506505 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:26:46.507721 [debug] [MainThread]: On master: COMMIT
[0m20:26:46.508697 [debug] [MainThread]: Using redshift connection "master"
[0m20:26:46.509408 [debug] [MainThread]: On master: COMMIT
[0m20:26:46.813728 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:26:46.815007 [debug] [MainThread]: On master: Close
[0m20:26:46.817979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:46.818441 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:26:46.818781 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:26:46.819184 [info ] [MainThread]: 
[0m20:26:46.819785 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 22.38 seconds (22.38s).
[0m20:26:46.820825 [debug] [MainThread]: Command end result
[0m20:26:46.844863 [info ] [MainThread]: 
[0m20:26:46.846542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:46.855295 [info ] [MainThread]: 
[0m20:26:46.856044 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:26:46.857288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.601067, "process_user_time": 2.589538, "process_kernel_time": 0.992398, "process_mem_max_rss": "120528", "process_out_blocks": "2888", "process_in_blocks": "0"}
[0m20:26:46.857972 [debug] [MainThread]: Command `dbt run` succeeded at 20:26:46.857833 after 23.60 seconds
[0m20:26:46.858384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64467b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff644e65b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6411ed4e0>]}
[0m20:26:46.858795 [debug] [MainThread]: Flushing usage events
[0m20:37:29.204683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce9586c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce744e0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce744e080>]}


============================== 20:37:29.207624 | d90ee41e-c982-488b-b42f-675e2507ad91 ==============================
[0m20:37:29.207624 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:37:29.209108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/fer/analytics_DBT/logs', 'version_check': 'True', 'profiles_dir': '/home/fer/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:37:29.617880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd90ee41e-c982-488b-b42f-675e2507ad91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce744e110>]}
[0m20:37:29.710894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd90ee41e-c982-488b-b42f-675e2507ad91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce6119960>]}
[0m20:37:29.712026 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m20:37:29.722914 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:37:29.821199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:37:29.822712 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m20:37:30.174507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd90ee41e-c982-488b-b42f-675e2507ad91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce5561ae0>]}
[0m20:37:30.246078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd90ee41e-c982-488b-b42f-675e2507ad91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce5df1d50>]}
[0m20:37:30.246893 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:37:30.248121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd90ee41e-c982-488b-b42f-675e2507ad91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce5df1f30>]}
[0m20:37:30.250017 [info ] [MainThread]: 
[0m20:37:30.251034 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:37:30.253730 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:37:30.295406 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:37:30.296672 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:37:30.297237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:30.300426 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:37:30.301101 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:37:31.675886 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:37:31.677554 [debug] [ThreadPool]: On list_dev: Close
[0m20:37:31.681470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m20:37:31.687372 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:37:31.688170 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:37:31.688568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:31.689109 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:37:31.689537 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:37:32.991240 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:37:32.991873 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:37:32.992267 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:37:33.320550 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:33.322060 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:37:33.641900 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:37:33.659292 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:33.660104 [debug] [MainThread]: On master: BEGIN
[0m20:37:33.660494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:33.661082 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:37:33.661453 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:37:34.974233 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:37:34.975337 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:34.976323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:37:35.342912 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:35.346723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd90ee41e-c982-488b-b42f-675e2507ad91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce5df0b80>]}
[0m20:37:35.347682 [debug] [MainThread]: On master: ROLLBACK
[0m20:37:35.684467 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:35.684975 [debug] [MainThread]: On master: BEGIN
[0m20:37:35.838530 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:35.839150 [debug] [MainThread]: On master: COMMIT
[0m20:37:35.839829 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:35.840653 [debug] [MainThread]: On master: COMMIT
[0m20:37:36.151269 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:36.153631 [debug] [MainThread]: On master: Close
[0m20:37:36.156200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:36.157392 [info ] [MainThread]: 
[0m20:37:36.163909 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:37:36.164500 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:37:36.165567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.my_first_dbt_model)
[0m20:37:36.166056 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:37:36.169632 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:37:36.171113 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:37:36.166470 => 20:37:36.170395
[0m20:37:36.171664 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:37:36.215994 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:37:36.218446 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:36.219009 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:37:36.219476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:36.220071 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:37:36.220726 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:37:37.533799 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:37:37.534659 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:37.535257 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:37:37.900354 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:37.904056 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:37:37.905569 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:37.906587 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:37:38.259168 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:38.260923 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:38.261575 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:37:38.430290 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:38.441556 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:37:38.445767 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:38.446295 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:37:38.762226 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:38.763488 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:37:38.764033 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:38.764641 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:37:38.958253 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:38.959348 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:38.960133 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:37:39.114775 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:39.122673 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:39.123505 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:37:39.904484 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:37:39.925146 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:37:39.925951 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:39.926410 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:37:40.281845 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:40.283880 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:40.285176 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:37:40.600493 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:40.606741 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:37:40.609102 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:40.609672 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:37:40.923788 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:40.926203 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:37:40.927212 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:40.928027 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:37:41.092045 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:41.094190 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:37:41.095457 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:37:41.251916 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:41.254967 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:37:36.171995 => 20:37:41.254455
[0m20:37:41.256124 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:37:41.568150 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:37:41.572096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd90ee41e-c982-488b-b42f-675e2507ad91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce65e10f0>]}
[0m20:37:41.573142 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 5.41s]
[0m20:37:41.574431 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:37:41.574949 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:37:41.575543 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:37:41.576972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:37:41.577454 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:37:41.580094 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:37:41.581498 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:37:41.577737 => 20:37:41.581240
[0m20:37:41.581915 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:37:41.599515 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:37:41.602438 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:41.602929 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:37:41.603337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:41.603874 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:37:41.604442 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:37:42.915426 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:37:42.915985 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:42.916372 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales AS (
    SELECT
        *
    FROM sales
),
renamed AS (
    SELECT
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA
    FROM source_sales
)
SELECT 
    *
FROM renamed
  ) ;
[0m20:37:43.406893 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:43.410118 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:37:43.411118 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:43.411724 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:37:43.759545 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:43.760472 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:43.760946 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:37:44.078787 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:44.083901 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m20:37:44.087370 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:44.087877 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m20:37:44.404728 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:44.406496 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:37:44.407262 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:44.407886 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:37:44.597408 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:44.599045 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:44.599980 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:37:44.758655 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:44.763701 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:44.764578 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:37:45.391361 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:37:45.393943 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:37:45.394598 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:45.395080 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:37:45.742003 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:45.743824 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:45.744967 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:37:46.060571 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:46.064726 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m20:37:46.066388 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:46.067075 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:37:46.382120 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:46.383194 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:37:46.383693 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:46.384037 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:37:46.571201 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:46.571866 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:37:46.572206 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:37:46.727645 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:46.729406 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:37:41.582196 => 20:37:46.729165
[0m20:37:46.730004 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:37:47.095989 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:37:47.099371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd90ee41e-c982-488b-b42f-675e2507ad91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce5550a60>]}
[0m20:37:47.112950 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 5.52s]
[0m20:37:47.114776 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:37:47.115809 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:37:47.116675 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:37:47.119246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:37:47.120166 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:37:47.129236 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:37:47.130203 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:37:47.120600 => 20:37:47.129921
[0m20:37:47.130821 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:37:47.135957 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:37:47.137474 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:37:47.137936 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:37:47.138323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:47.138793 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:37:47.139210 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:37:48.447468 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:37:48.448203 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:37:48.448992 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:37:48.935577 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:48.947528 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:37:48.949684 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:37:49.414819 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:49.416887 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:37:49.417497 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:37:49.417912 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:37:49.756294 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:49.757401 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:37:49.758162 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:37:50.077555 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:50.081316 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:37:50.082641 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:37:50.083038 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:37:50.393417 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:50.395053 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:37:50.395529 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:37:50.395847 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:37:50.575611 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:50.576522 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:37:50.577015 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:37:50.732967 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:50.734212 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:37:47.131093 => 20:37:50.734010
[0m20:37:50.734567 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:37:51.045402 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:37:51.047367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd90ee41e-c982-488b-b42f-675e2507ad91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce5df1990>]}
[0m20:37:51.048445 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 3.93s]
[0m20:37:51.049840 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:37:51.052824 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:51.053266 [debug] [MainThread]: On master: BEGIN
[0m20:37:51.053575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:37:51.054025 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:37:51.054372 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:37:52.333246 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:37:52.334349 [debug] [MainThread]: On master: COMMIT
[0m20:37:52.335883 [debug] [MainThread]: Using redshift connection "master"
[0m20:37:52.336615 [debug] [MainThread]: On master: COMMIT
[0m20:37:52.648059 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:37:52.648967 [debug] [MainThread]: On master: Close
[0m20:37:52.650140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:52.650564 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:37:52.651020 [info ] [MainThread]: 
[0m20:37:52.651834 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 22.40 seconds (22.40s).
[0m20:37:52.653616 [debug] [MainThread]: Command end result
[0m20:37:52.664605 [info ] [MainThread]: 
[0m20:37:52.665492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:37:52.666212 [info ] [MainThread]: 
[0m20:37:52.666896 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:37:52.679581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.538427, "process_user_time": 2.259007, "process_kernel_time": 1.958348, "process_mem_max_rss": "120288", "process_in_blocks": "8", "process_out_blocks": "2888"}
[0m20:37:52.680712 [debug] [MainThread]: Command `dbt run` succeeded at 20:37:52.680527 after 23.54 seconds
[0m20:37:52.681160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce9586c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce4530610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce744e110>]}
[0m20:37:52.681586 [debug] [MainThread]: Flushing usage events
[0m20:53:44.507474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340428ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340215e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340215e0e0>]}


============================== 20:53:44.510078 | 69e66fbb-4eed-410d-90f4-425875637f1d ==============================
[0m20:53:44.510078 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:53:44.510698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/fer/analytics_DBT/logs', 'debug': 'False', 'profiles_dir': '/home/fer/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:53:45.056532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340215e170>]}
[0m20:53:45.141451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340115e260>]}
[0m20:53:45.142605 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m20:53:45.157460 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:53:45.173264 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:53:45.173977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34015dd990>]}
[0m20:53:46.400234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ffd68460>]}
[0m20:53:46.418113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34015a2020>]}
[0m20:53:46.418809 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:53:46.419301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34001051b0>]}
[0m20:53:46.420609 [info ] [MainThread]: 
[0m20:53:46.421603 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:53:46.423158 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:53:46.446784 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:53:46.448915 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:53:46.449649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:46.453367 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:53:46.453944 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:53:47.825677 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:53:47.827437 [debug] [ThreadPool]: On list_dev: Close
[0m20:53:47.832830 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:53:47.840156 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:53:47.841348 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:53:47.841835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:47.842532 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:53:47.842997 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:53:49.112835 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:53:49.113652 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:53:49.114171 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:53:49.455084 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:49.456659 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:53:49.764471 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:53:49.775484 [debug] [MainThread]: Using redshift connection "master"
[0m20:53:49.776010 [debug] [MainThread]: On master: BEGIN
[0m20:53:49.776597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:49.777124 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:53:49.777503 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:53:51.067065 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:53:51.068277 [debug] [MainThread]: Using redshift connection "master"
[0m20:53:51.068858 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:53:51.439286 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:51.441061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ffd69600>]}
[0m20:53:51.441641 [debug] [MainThread]: On master: ROLLBACK
[0m20:53:51.779987 [debug] [MainThread]: Using redshift connection "master"
[0m20:53:51.781175 [debug] [MainThread]: On master: BEGIN
[0m20:53:51.975251 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:51.976017 [debug] [MainThread]: On master: COMMIT
[0m20:53:51.976822 [debug] [MainThread]: Using redshift connection "master"
[0m20:53:51.977219 [debug] [MainThread]: On master: COMMIT
[0m20:53:52.296919 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:52.298089 [debug] [MainThread]: On master: Close
[0m20:53:52.300356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:53:52.301146 [info ] [MainThread]: 
[0m20:53:52.307311 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:53:52.307931 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:53:52.308796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.my_first_dbt_model)
[0m20:53:52.309221 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:53:52.312150 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:53:52.313877 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:53:52.309628 => 20:53:52.313183
[0m20:53:52.314324 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:53:52.360068 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:53:52.367610 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:52.368215 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:53:52.368603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:52.369136 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:53:52.369536 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:53:53.701180 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:53:53.701734 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:53.702125 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:53:54.076333 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:54.079106 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:53:54.080052 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:54.080835 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:53:54.463255 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:54.465367 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:54.466189 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:53:54.635125 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:54.642352 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:53:54.648694 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:54.650033 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:53:54.974383 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:54.976152 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:53:54.976983 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:54.977483 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:53:55.170170 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:55.171678 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:55.172882 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:53:55.331819 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:55.338238 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:55.338771 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:53:56.145299 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:53:56.166899 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:53:56.167577 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:56.168006 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:53:56.513229 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:56.514169 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:56.514598 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:53:56.831854 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:56.835024 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:53:56.836473 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:56.836950 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:53:57.154322 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:57.155379 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:53:57.155907 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:57.156497 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:53:57.323205 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:57.324176 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:53:57.324724 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:53:57.484915 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:57.487319 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:53:52.314626 => 20:53:57.486936
[0m20:53:57.488436 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:53:57.829344 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:53:57.832931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33fe106980>]}
[0m20:53:57.834323 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 5.52s]
[0m20:53:57.836298 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:53:57.837029 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:53:57.837709 [info ] [Thread-1 (]: 2 of 4 START sql view model public.vw_sales .................................... [RUN]
[0m20:53:57.839065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:53:57.839614 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:53:57.841900 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:53:57.843109 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:53:57.840097 => 20:53:57.842667
[0m20:53:57.843662 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:53:57.872468 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:53:57.875553 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:53:57.876307 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:53:57.876772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:57.877332 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:53:57.877770 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:53:59.166511 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:53:59.168051 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:53:59.169148 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales AS (
    SELECT
        *
    FROM sales
),
renamed AS (
    SELECT
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA
    FROM source_sales
)
SELECT 
    *
FROM renamed
  ) ;
[0m20:53:59.659901 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:53:59.661527 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:53:59.662255 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:53:59.662769 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:54:00.006763 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:00.007931 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:54:00.009119 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:54:00.323613 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:00.328918 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m20:54:00.333136 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:54:00.333800 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m20:54:00.654219 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:00.656013 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:54:00.656582 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:54:00.656940 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:54:00.840148 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:00.840992 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:54:00.841530 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:54:00.997242 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:01.002577 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:54:01.003461 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:54:01.630321 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:54:01.633172 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:54:01.633906 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:54:01.634359 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:54:02.007149 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:02.008226 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:54:02.008732 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:54:02.321033 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:02.323994 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m20:54:02.325163 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:54:02.325514 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:54:02.671438 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:02.672715 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:54:02.673264 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:54:02.673612 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:54:02.854182 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:02.854840 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:54:02.855281 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:54:03.011676 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:03.014226 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:53:57.843988 => 20:54:03.013899
[0m20:54:03.014870 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:54:03.328931 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:54:03.332533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33fd00f610>]}
[0m20:54:03.333955 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 5.49s]
[0m20:54:03.334840 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:54:03.335446 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:54:03.336248 [info ] [Thread-1 (]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:54:03.337179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:54:03.337651 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:54:03.341174 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:54:03.342689 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:54:03.337949 => 20:54:03.342286
[0m20:54:03.343250 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:54:03.365429 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:54:03.367690 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:54:03.369416 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:54:03.370155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:03.371036 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:54:03.371667 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:54:04.701205 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:54:04.702145 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:54:04.702643 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:54:05.191662 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:05.199125 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:54:05.199917 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:54:05.691806 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:05.694898 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:54:05.695737 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:54:05.696206 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:54:06.052860 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:06.053802 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:54:06.054242 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:54:06.405382 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:06.410786 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:54:06.412098 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:54:06.412708 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:54:06.737687 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:06.738726 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:54:06.739223 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:54:06.739535 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:54:06.925054 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:06.925722 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:54:06.926112 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:54:07.088664 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:07.091912 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:54:03.343581 => 20:54:07.091686
[0m20:54:07.092660 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:54:07.469247 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:54:07.470512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ff9e1960>]}
[0m20:54:07.471192 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.13s]
[0m20:54:07.472217 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:54:07.472796 [debug] [Thread-1 (]: Began running node model.analytics_dbt.tb_10_compradores
[0m20:54:07.473618 [info ] [Thread-1 (]: 4 of 4 START sql table model public.tb_10_compradores .......................... [RUN]
[0m20:54:07.474388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_second_dbt_model, now model.analytics_dbt.tb_10_compradores)
[0m20:54:07.474798 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m20:54:07.477895 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m20:54:07.478658 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_10_compradores (compile): 20:54:07.475053 => 20:54:07.478417
[0m20:54:07.479084 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.tb_10_compradores
[0m20:54:07.484185 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.tb_10_compradores"
[0m20:54:07.488751 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:54:07.489411 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:54:07.489891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:07.490532 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:54:07.491018 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:54:08.784883 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:54:08.785870 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:54:08.786427 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */

  
    

  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    WITH sales AS (
    SELECT
        *
    FROM "dev"."public"."vw_sales"
),
compradores AS (
    SELECT
        (firtsname ||''|| lastname) as nome_completo,
        userid
    FROM users
),
top_10_compradores AS (
    SELECT
        compradores.nome_completo AS nome_completo,
        SUM(sales.quantidade_vendida) AS vendas_totais,
        sales.comissao AS comissao
    FROM compradores
    INNER JOIN sales
        ON sales.id_comprador = compradores.userid
    GROUP BY compradores.userid, compradores.nome_completo, sales.comissao
    ORDER BY vendas_totais DESC
    LIMIT 10
)
SELECT
    *
FROM top_10_compradores
  );
[0m20:54:08.980641 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "firtsname" does not exist in users
[0m20:54:08.981863 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m20:54:09.305903 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_10_compradores (execute): 20:54:07.479353 => 20:54:09.305337
[0m20:54:09.306768 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: Close
[0m20:54:09.312540 [debug] [Thread-1 (]: Database Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  column "firtsname" does not exist in users
  compiled Code at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m20:54:09.313498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69e66fbb-4eed-410d-90f4-425875637f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ffd69630>]}
[0m20:54:09.314311 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.tb_10_compradores ................. [[31mERROR[0m in 1.84s]
[0m20:54:09.315162 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.tb_10_compradores
[0m20:54:09.318994 [debug] [MainThread]: Using redshift connection "master"
[0m20:54:09.319535 [debug] [MainThread]: On master: BEGIN
[0m20:54:09.319880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:09.320346 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:54:09.320683 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:54:10.575547 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:54:10.576726 [debug] [MainThread]: On master: COMMIT
[0m20:54:10.577910 [debug] [MainThread]: Using redshift connection "master"
[0m20:54:10.578562 [debug] [MainThread]: On master: COMMIT
[0m20:54:10.887274 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:54:10.889018 [debug] [MainThread]: On master: Close
[0m20:54:10.891328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:10.891920 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:54:10.892704 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m20:54:10.893222 [info ] [MainThread]: 
[0m20:54:10.893800 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 24.47 seconds (24.47s).
[0m20:54:10.894874 [debug] [MainThread]: Command end result
[0m20:54:10.911363 [info ] [MainThread]: 
[0m20:54:10.912398 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:54:10.913046 [info ] [MainThread]: 
[0m20:54:10.914222 [error] [MainThread]:   Database Error in model tb_10_compradores (models/tables/tb_10_compradores.sql)
  column "firtsname" does not exist in users
  compiled Code at target/run/analytics_dbt/models/tables/tb_10_compradores.sql
[0m20:54:10.915042 [info ] [MainThread]: 
[0m20:54:10.915618 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:54:10.916978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.476, "process_user_time": 3.867988, "process_kernel_time": 0.696415, "process_mem_max_rss": "124248", "process_in_blocks": "8", "process_out_blocks": "2936", "command_success": false}
[0m20:54:10.917985 [debug] [MainThread]: Command `dbt run` failed at 20:54:10.917819 after 26.48 seconds
[0m20:54:10.918389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340428ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3400d70280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340115e260>]}
[0m20:54:10.918809 [debug] [MainThread]: Flushing usage events
[0m20:55:35.914661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32a0a7aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329e962170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329e962110>]}


============================== 20:55:35.917612 | 64b68b0b-dae9-4746-86a9-13f90dd08985 ==============================
[0m20:55:35.917612 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:55:35.918309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/fer/analytics_DBT/logs', 'version_check': 'True', 'profiles_dir': '/home/fer/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:55:36.152287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64b68b0b-dae9-4746-86a9-13f90dd08985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329e9621a0>]}
[0m20:55:36.233652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64b68b0b-dae9-4746-86a9-13f90dd08985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329d9492a0>]}
[0m20:55:36.234530 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m20:55:36.243833 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:55:36.308814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:55:36.310698 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_10_compradores.sql
[0m20:55:36.497056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64b68b0b-dae9-4746-86a9-13f90dd08985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329cd9e050>]}
[0m20:55:36.507599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64b68b0b-dae9-4746-86a9-13f90dd08985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329d1262f0>]}
[0m20:55:36.508409 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:55:36.509075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64b68b0b-dae9-4746-86a9-13f90dd08985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329d1264a0>]}
[0m20:55:36.510507 [info ] [MainThread]: 
[0m20:55:36.511300 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:55:36.518258 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:55:36.541806 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:55:36.542407 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:55:36.542790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:36.546207 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:55:36.546865 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:55:37.883903 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:55:37.885804 [debug] [ThreadPool]: On list_dev: Close
[0m20:55:37.888442 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:55:37.896122 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:55:37.896822 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:55:37.897278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:37.897918 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:55:37.898821 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:55:39.174880 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:55:39.176700 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:55:39.177706 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:55:39.509483 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:39.511457 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:55:39.831967 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:55:39.850041 [debug] [MainThread]: Using redshift connection "master"
[0m20:55:39.850576 [debug] [MainThread]: On master: BEGIN
[0m20:55:39.850915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:39.851496 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:55:39.851845 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:55:41.130634 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:55:41.133023 [debug] [MainThread]: Using redshift connection "master"
[0m20:55:41.134352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:55:41.504929 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:41.510946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64b68b0b-dae9-4746-86a9-13f90dd08985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329d125090>]}
[0m20:55:41.511716 [debug] [MainThread]: On master: ROLLBACK
[0m20:55:41.847572 [debug] [MainThread]: Using redshift connection "master"
[0m20:55:41.848038 [debug] [MainThread]: On master: BEGIN
[0m20:55:42.006648 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:42.007479 [debug] [MainThread]: On master: COMMIT
[0m20:55:42.008665 [debug] [MainThread]: Using redshift connection "master"
[0m20:55:42.009436 [debug] [MainThread]: On master: COMMIT
[0m20:55:42.342940 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:42.344622 [debug] [MainThread]: On master: Close
[0m20:55:42.346394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:42.347327 [info ] [MainThread]: 
[0m20:55:42.352192 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:55:42.352769 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:55:42.353742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.analytics_dbt.my_first_dbt_model)
[0m20:55:42.354181 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:55:42.358115 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:55:42.370675 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:55:42.354499 => 20:55:42.370212
[0m20:55:42.373246 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:55:42.445344 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:55:42.453204 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:42.453896 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:55:42.454350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:42.454999 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:55:42.455552 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:55:43.769654 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:55:43.771039 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:43.772241 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:55:44.132501 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:44.134099 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:55:44.134745 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:44.135241 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:55:44.490983 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:44.492657 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:44.493672 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:55:44.652061 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:44.659976 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:55:44.665243 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:44.665837 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:55:44.988346 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:44.991156 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:55:44.991700 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:44.992131 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:55:45.183191 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:45.185434 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:45.186062 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:55:45.343460 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:45.349611 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:45.350360 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:55:46.159991 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:55:46.180254 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:55:46.181058 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:46.181506 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:55:46.528598 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:46.529531 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:46.530070 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:55:46.852057 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:46.861378 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:55:46.863789 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:46.864598 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:55:47.209129 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:47.211331 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:55:47.212567 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:47.214007 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:55:47.381584 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:47.382598 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:55:47.383209 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:55:47.540749 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:47.542214 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:55:42.373707 => 20:55:47.542008
[0m20:55:47.542737 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:55:47.871583 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:55:47.874348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b68b0b-dae9-4746-86a9-13f90dd08985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329c15f940>]}
[0m20:55:47.875110 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 5.52s]
[0m20:55:47.875824 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:55:47.876289 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:55:47.877413 [info ] [Thread-1 (]: 2 of 4 START sql view model public.vw_sales .................................... [RUN]
[0m20:55:47.878348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:55:47.878739 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:55:47.883057 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:55:47.884384 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:55:47.878979 => 20:55:47.883679
[0m20:55:47.884774 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:55:47.907407 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:55:47.910408 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:47.910900 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:55:47.911249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:47.911834 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:55:47.912205 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:55:49.223591 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:55:49.224606 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:49.225261 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales AS (
    SELECT
        *
    FROM sales
),
renamed AS (
    SELECT
        SALESID AS ID_VENDA,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') AS DATA_HORA_VENDA,
        CAST(SALETIME AS DATE) AS DATA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') AS HORA_VENDA
    FROM source_sales
)
SELECT 
    *
FROM renamed
  ) ;
[0m20:55:49.735146 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:55:49.739116 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:55:49.740487 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:49.741507 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:55:50.101408 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:50.102243 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:50.102714 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:55:50.411473 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:50.415028 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m20:55:50.418793 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:50.428563 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m20:55:50.743016 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:50.745661 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:55:50.746647 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:50.747362 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:55:50.929228 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:50.929870 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:50.930257 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:55:51.085081 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:51.088421 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:51.089061 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:55:51.718392 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:55:51.720896 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:55:51.721556 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:51.722022 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:55:52.060960 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:52.062011 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:52.062573 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:55:52.382477 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:52.385561 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m20:55:52.386799 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:52.387260 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:55:52.698896 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:52.699918 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:55:52.700380 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:52.701072 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:55:52.891127 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:52.892050 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:55:52.892569 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:55:53.049405 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:53.051026 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:55:47.884981 => 20:55:53.050790
[0m20:55:53.051544 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:55:53.362256 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:55:53.365557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b68b0b-dae9-4746-86a9-13f90dd08985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329c13de70>]}
[0m20:55:53.367210 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 5.49s]
[0m20:55:53.369258 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:55:53.369971 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:55:53.370725 [info ] [Thread-1 (]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:55:53.371773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:55:53.372476 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:55:53.376212 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:55:53.377930 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:55:53.372741 => 20:55:53.377449
[0m20:55:53.379143 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:55:53.383424 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:55:53.385462 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:55:53.385918 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:55:53.386306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:53.386850 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:55:53.387245 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:55:54.644827 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:55:54.646082 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:55:54.647050 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:55:55.102913 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:55.106842 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:55:55.107418 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:55:55.559503 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:55.561696 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:55:55.562338 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:55:55.562781 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:55:55.917258 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:55.918538 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:55:55.919624 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:55:56.232585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:56.237302 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:55:56.241715 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:55:56.261120 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:55:56.577826 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:56.579136 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:55:56.579643 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:55:56.579976 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:55:56.760566 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:56.761352 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:55:56.761797 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:55:56.913485 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:55:56.916563 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:55:53.379520 => 20:55:56.916006
[0m20:55:56.918057 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:55:57.229388 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:55:57.231465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b68b0b-dae9-4746-86a9-13f90dd08985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329c5f5510>]}
[0m20:55:57.232257 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 3.86s]
[0m20:55:57.233585 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:55:57.234268 [debug] [Thread-1 (]: Began running node model.analytics_dbt.tb_10_compradores
[0m20:55:57.234945 [info ] [Thread-1 (]: 4 of 4 START sql table model public.tb_10_compradores .......................... [RUN]
[0m20:55:57.235924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_second_dbt_model, now model.analytics_dbt.tb_10_compradores)
[0m20:55:57.236808 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m20:55:57.241720 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m20:55:57.243185 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_10_compradores (compile): 20:55:57.237159 => 20:55:57.242839
[0m20:55:57.243711 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.tb_10_compradores
[0m20:55:57.258383 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.tb_10_compradores"
[0m20:55:57.261433 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:55:57.263529 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:55:57.264556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:57.265175 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:55:57.265625 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:55:58.556353 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:55:58.558317 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:55:58.559331 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */

  
    

  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    WITH sales AS (
    SELECT
        *
    FROM "dev"."public"."vw_sales"
),
compradores AS (
    SELECT
        (firstname ||''|| lastname) as nome_completo,
        userid
    FROM users
),
top_10_compradores AS (
    SELECT
        compradores.nome_completo AS nome_completo,
        SUM(sales.quantidade_vendida) AS vendas_totais,
        sales.comissao AS comissao
    FROM compradores
    INNER JOIN sales
        ON sales.id_comprador = compradores.userid
    GROUP BY compradores.userid, compradores.nome_completo, sales.comissao
    ORDER BY vendas_totais DESC
    LIMIT 10
)
SELECT
    *
FROM top_10_compradores
  );
[0m20:56:16.990403 [debug] [Thread-1 (]: SQL status: SUCCESS in 18.0 seconds
[0m20:56:17.000490 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:56:17.005383 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
[0m20:56:17.631784 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:56:17.633992 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:56:17.634512 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:56:17.634835 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:56:17.992168 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:56:17.993313 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:56:17.994102 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:56:18.305013 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:56:18.308335 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_10_compradores__dbt_backup"
[0m20:56:18.309824 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:56:18.310275 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop table if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
[0m20:56:18.634750 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:56:18.637274 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:56:18.638872 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:56:18.639536 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m20:56:18.804012 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:56:18.805857 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m20:56:18.807267 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m20:56:18.962607 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:56:18.965260 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_10_compradores (execute): 20:55:57.243993 => 20:56:18.964828
[0m20:56:18.966178 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m20:56:19.279434 [debug] [Thread-1 (]: On model.analytics_dbt.tb_10_compradores: Close
[0m20:56:19.283982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b68b0b-dae9-4746-86a9-13f90dd08985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329c1d3220>]}
[0m20:56:19.285397 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.tb_10_compradores ..................... [[32mSUCCESS[0m in 22.05s]
[0m20:56:19.286426 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.tb_10_compradores
[0m20:56:19.289153 [debug] [MainThread]: Using redshift connection "master"
[0m20:56:19.289525 [debug] [MainThread]: On master: BEGIN
[0m20:56:19.289801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:19.290219 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:56:19.290509 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:56:20.634206 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:56:20.636962 [debug] [MainThread]: On master: COMMIT
[0m20:56:20.638572 [debug] [MainThread]: Using redshift connection "master"
[0m20:56:20.639508 [debug] [MainThread]: On master: COMMIT
[0m20:56:20.950529 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:56:20.951130 [debug] [MainThread]: On master: Close
[0m20:56:20.952431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:20.952844 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:56:20.953151 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m20:56:20.953524 [info ] [MainThread]: 
[0m20:56:20.954166 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 44.44 seconds (44.44s).
[0m20:56:20.955365 [debug] [MainThread]: Command end result
[0m20:56:20.964445 [info ] [MainThread]: 
[0m20:56:20.966023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:56:20.969504 [info ] [MainThread]: 
[0m20:56:20.970255 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:56:20.971378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 45.10706, "process_user_time": 2.609876, "process_kernel_time": 0.763501, "process_mem_max_rss": "121036", "process_out_blocks": "2960", "process_in_blocks": "0"}
[0m20:56:20.972172 [debug] [MainThread]: Command `dbt run` succeeded at 20:56:20.972013 after 45.11 seconds
[0m20:56:20.972827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32a0a7aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329c1ab580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f329c51dba0>]}
[0m20:56:20.973332 [debug] [MainThread]: Flushing usage events
[0m21:18:22.858762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa879aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa666a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa666a140>]}


============================== 21:18:22.869965 | 7d04f958-4167-4b79-be55-e738efef5e08 ==============================
[0m21:18:22.869965 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:18:22.871515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/fer/analytics_DBT/logs', 'debug': 'False', 'profiles_dir': '/home/fer/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m models/tables/tb_vendas_primeiro_trimestre.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:23.337170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d04f958-4167-4b79-be55-e738efef5e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa666a1d0>]}
[0m21:18:23.458299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d04f958-4167-4b79-be55-e738efef5e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa59625f0>]}
[0m21:18:23.459693 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m21:18:23.477646 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:18:23.561095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:18:23.562075 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
[0m21:18:23.562747 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_10_compradores.sql
[0m21:18:23.758197 [error] [MainThread]: Encountered an error:
Compilation Error in model tb_vendas_primeiro_trimestre (models/tables/tb_vendas_primeiro_trimestre.sql)
  Encountered unknown tag 'SET'.
    line 3
      {% SET meses = ("JAN","FEV","MAR")%}
[0m21:18:23.760808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.95832205, "process_user_time": 2.541724, "process_kernel_time": 1.557831, "process_mem_max_rss": "110180", "process_in_blocks": "8", "process_out_blocks": "16", "command_success": false}
[0m21:18:23.762222 [debug] [MainThread]: Command `dbt run` failed at 21:18:23.761995 after 0.96 seconds
[0m21:18:23.763111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa879aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa51bd510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aa51bd6f0>]}
[0m21:18:23.763760 [debug] [MainThread]: Flushing usage events
[0m21:18:50.288747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649e197700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649c0661d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649c066170>]}


============================== 21:18:50.291240 | 88e59ecc-4a92-4deb-a9c8-f1d41940056d ==============================
[0m21:18:50.291240 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:18:50.291907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/fer/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/fer/analytics_DBT/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m models/tables/tb_vendas_primeiro_trimestre.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:50.517476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88e59ecc-4a92-4deb-a9c8-f1d41940056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649c066200>]}
[0m21:18:50.598476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88e59ecc-4a92-4deb-a9c8-f1d41940056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649b363460>]}
[0m21:18:50.599510 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m21:18:50.608962 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:18:50.636439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:18:50.638753 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
[0m21:18:50.639689 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/tables/tb_10_compradores.sql
[0m21:18:50.823586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88e59ecc-4a92-4deb-a9c8-f1d41940056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649a7de800>]}
[0m21:18:50.841298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88e59ecc-4a92-4deb-a9c8-f1d41940056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649ab46440>]}
[0m21:18:50.841893 [info ] [MainThread]: Found 5 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:18:50.842563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88e59ecc-4a92-4deb-a9c8-f1d41940056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649ab465f0>]}
[0m21:18:50.844006 [info ] [MainThread]: 
[0m21:18:50.845098 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:18:50.847075 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m21:18:50.864356 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m21:18:50.865367 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m21:18:50.866073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:50.869833 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:18:50.872882 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:20:07.208408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:07.209875 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m21:20:07.212741 [info ] [MainThread]: 
[0m21:20:07.213371 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 16.37 seconds (76.37s).
[0m21:20:07.214882 [error] [MainThread]: Encountered an error:

[0m21:20:07.237828 [error] [MainThread]: Traceback (most recent call last):
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/task/runnable.py", line 572, in create_schemas
    for ls_future in as_completed(list_futures):
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 245, in as_completed
    waiter.event.wait(wait_timeout)
  File "/usr/lib/python3.10/threading.py", line 607, in wait
    signaled = self._cond.wait(timeout)
  File "/usr/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 284, in wrapper
    return func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/task/runnable.py", line 434, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/task/run.py", line 446, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/task/runnable.py", line 563, in create_schemas
    with dbt.utils.executor(self.config) as tpe:
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 649, in __exit__
    self.shutdown(wait=True)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 235, in shutdown
    t.join()
  File "/usr/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m21:20:07.242718 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 76.99137, "process_user_time": 1.940279, "process_kernel_time": 0.357781, "process_mem_max_rss": "114960", "process_in_blocks": "48", "process_out_blocks": "1912", "command_success": false}
[0m21:20:07.244770 [debug] [MainThread]: Command `dbt run` failed at 21:20:07.244330 after 76.99 seconds
[0m21:20:07.246604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649e197700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649ab46230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f649a7a1a20>]}
[0m21:20:07.247519 [debug] [MainThread]: Flushing usage events
[0m21:20:11.633872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1f186050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1d0321d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1d032170>]}


============================== 21:20:11.644676 | fb422744-37db-4a56-a162-ebcb9cf7e625 ==============================
[0m21:20:11.644676 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:20:11.646541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/fer/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/fer/analytics_DBT/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m models/tables/tb_vendas_primeiro_trimestre.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:20:11.895711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb422744-37db-4a56-a162-ebcb9cf7e625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1c9dfeb0>]}
[0m21:20:11.976353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb422744-37db-4a56-a162-ebcb9cf7e625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1bf5f460>]}
[0m21:20:11.977514 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m21:20:11.989637 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:20:12.027887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:12.028940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:12.035322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb422744-37db-4a56-a162-ebcb9cf7e625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1b781090>]}
[0m21:20:12.050508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb422744-37db-4a56-a162-ebcb9cf7e625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1b746860>]}
[0m21:20:12.051171 [info ] [MainThread]: Found 5 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:20:12.051735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb422744-37db-4a56-a162-ebcb9cf7e625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1b7469e0>]}
[0m21:20:12.053719 [info ] [MainThread]: 
[0m21:20:12.057381 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:20:12.060216 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m21:20:12.084834 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m21:20:12.085419 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m21:20:12.085847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:12.090878 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:20:12.091698 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:20:21.964986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:21.965529 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m21:20:21.965894 [info ] [MainThread]: 
[0m21:20:21.966413 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 9.91 seconds (9.91s).
[0m21:20:21.966928 [error] [MainThread]: Encountered an error:

[0m21:20:21.968453 [error] [MainThread]: Traceback (most recent call last):
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/task/runnable.py", line 572, in create_schemas
    for ls_future in as_completed(list_futures):
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 245, in as_completed
    waiter.event.wait(wait_timeout)
  File "/usr/lib/python3.10/threading.py", line 607, in wait
    signaled = self._cond.wait(timeout)
  File "/usr/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/requires.py", line 284, in wrapper
    return func(*args, **kwargs)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/task/runnable.py", line 434, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/task/run.py", line 446, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/fer/dbt-env/lib/python3.10/site-packages/dbt/task/runnable.py", line 563, in create_schemas
    with dbt.utils.executor(self.config) as tpe:
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 649, in __exit__
    self.shutdown(wait=True)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 235, in shutdown
    t.join()
  File "/usr/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m21:20:21.969705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.377103, "process_user_time": 1.687193, "process_kernel_time": 0.574758, "process_mem_max_rss": "112460", "process_out_blocks": "960", "command_success": false, "process_in_blocks": "0"}
[0m21:20:21.970443 [debug] [MainThread]: Command `dbt run` failed at 21:20:21.970254 after 10.38 seconds
[0m21:20:21.971101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1f186050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1b7465c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1b7c2d40>]}
[0m21:20:21.971822 [debug] [MainThread]: Flushing usage events
[0m21:20:26.841486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d88e7b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d86cf21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d86cf2170>]}


============================== 21:20:26.844370 | 502f9b8e-08f2-4db4-91c1-88436bc6bbc4 ==============================
[0m21:20:26.844370 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:20:26.845079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/fer/analytics_DBT/logs', 'profiles_dir': '/home/fer/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:20:27.102681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '502f9b8e-08f2-4db4-91c1-88436bc6bbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d86cf2200>]}
[0m21:20:27.199623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '502f9b8e-08f2-4db4-91c1-88436bc6bbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d85d4b460>]}
[0m21:20:27.200668 [info ] [MainThread]: Registered adapter: redshift=1.7.1
[0m21:20:27.213325 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:20:27.242017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:27.242625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:27.249251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '502f9b8e-08f2-4db4-91c1-88436bc6bbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d85565090>]}
[0m21:20:27.267833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '502f9b8e-08f2-4db4-91c1-88436bc6bbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8552a860>]}
[0m21:20:27.268715 [info ] [MainThread]: Found 5 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:20:27.269244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '502f9b8e-08f2-4db4-91c1-88436bc6bbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8552a9e0>]}
[0m21:20:27.272185 [info ] [MainThread]: 
[0m21:20:27.275118 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:20:27.277224 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m21:20:27.302544 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m21:20:27.303309 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m21:20:27.303771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:27.311844 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:20:27.317841 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
